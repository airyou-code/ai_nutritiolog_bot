# üöÄ –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## üìã –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö SQLAlchemy + Alembic

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL
```bash
# –° Docker Compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
docker compose up -d db

# –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL –ª–æ–∫–∞–ª—å–Ω–æ
```

### 2. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `.env`
```env
# Database Configuration
DATABASE_URL=postgresql+asyncpg://aichat:dev_password_123@localhost:5432/aichat_bot

# Bot Configuration
BOT_TOKEN=your_bot_token_here

# OpenAI Configuration  
OPENAI_API_KEY=your_openai_api_key_here

# Optional settings
REDIS_URL=redis://localhost:6379/0
DEBUG=false
LOG_LEVEL=INFO
```

### 3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ (—Å–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã)
uv run alembic upgrade head

# –ò–ª–∏ —á–µ—Ä–µ–∑ —É—Ç–∏–ª–∏—Ç–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
uv run python db_utils.py init
```

### 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
```bash
uv run python -m bot.main
```

## üõ†Ô∏è –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `uv run python db_utils.py init` | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö |
| `uv run python db_utils.py status` | –°—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–π |
| `uv run python db_utils.py migrate "–æ–ø–∏—Å–∞–Ω–∏–µ"` | –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é |
| `uv run python db_utils.py rollback` | –û—Ç–∫–∞—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é |

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:**
- ‚úÖ `telegram_users` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–æ—Ç–∞ (ID, –∏–º—è, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∏—Ç–∞–Ω–∏—è)
- ‚úÖ `food_entries` - –∑–∞–ø–∏—Å–∏ –æ –µ–¥–µ (–ë–ñ–£, –∫–∞–ª–æ—Ä–∏–∏, —Ñ–æ—Ç–æ, –¥–∞—Ç–∞)
- ‚úÖ `alembic_version` - –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ö–µ–º—ã

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

**–û—à–∏–±–∫–∞ "AttributeError: 'Message' object has no attribute 'message'"**
‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - middleware —Ç–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã —Å–æ–±—ã—Ç–∏–π

**–û—à–∏–±–∫–∞ "greenlet library is required"**
‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `greenlet`

**–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ DATABASE_URL –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤ `.env`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–æ–ª—å –∏ –∏–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö 